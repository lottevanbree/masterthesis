<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>My Website</title>
    <link rel="stylesheet" href="./style.css">
    <script
		src="https://code.jquery.com/jquery-3.4.1.js"
		integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
		crossorigin="anonymous"></script>
  </head>
  <body>
    <main>
      <div class="progress">
        <iconify-icon icon="fa-solid:dot-circle" style="color: #1ad760;vertical-align: middle;" width="10"></iconify-icon>
        <hr>
        <iconify-icon icon="fa-solid:dot-circle" style="color: #1ad760;vertical-align: middle;" width="10"></iconify-icon>
        <hr>
        <iconify-icon icon="fa-solid:dot-circle" style="color: #1ad760;vertical-align: middle;" width="10"></iconify-icon>
        <hr>
        <iconify-icon icon="fa-solid:dot-circle" style="color: #1ad760;vertical-align: middle;" width="10"></iconify-icon>
        <hr>
        <iconify-icon icon="fa-solid:dot-circle" style="color: #1ad760;vertical-align: middle;" width="10"></iconify-icon>
        <hr>
        <iconify-icon icon="fa-solid:dot-circle" style="color: #1ad760;vertical-align: middle;" width="10"></iconify-icon>
        <hr>
        <iconify-icon icon="fa-solid:dot-circle" style="color: #1ad760;vertical-align: middle;" width="10"></iconify-icon>
        <hr>
        <iconify-icon icon="fa-solid:dot-circle" style="color: #1ad760;vertical-align: middle;" width="10"></iconify-icon>
        <hr>    
        <iconify-icon icon="fa-solid:dot-circle" style="color: #1ad760;vertical-align: middle;" width="10"></iconify-icon>
        <hr>
        <iconify-icon icon="vaadin:dot-circle" style="color: #1ad760;vertical-align: middle;" width="10"></iconify-icon>
      </div>
      <div id="intro6">
        <h1>Survey - part IV</h1>  
        <h3>General questions regarding personalisation</h3>
        <p class="index2">The final section of the survey consists of a few questions regarding your own experiences within music streaming platforms. Once you have answered these questions, you can submit your responses and your participation will be complete.</p>
       <form id="myForm">
        <div class="questions">
          <table>
            <tr class="backtable">
              <th id="likert">Questions</th>
              <th>Strongly Disagree</th>
              <th>Disagree</th>
              <th>Neutral</th>
              <th>Agree</th>
              <th>Strongly Agree</th>
            </tr>
            <tr class="backtable-soft question">
              <td class="question-text">The playlist title's use of personal pronouns (e.g. "my," "our") make me feel like the playlist was created specifically for me.</td>
              <td><input type="radio" name="general1" value="1"></td>
              <td><input type="radio" name="general1" value="2"></td>
              <td><input type="radio" name="general1" value="3"></td>
              <td><input type="radio" name="general1" value="4"></td>
              <td><input type="radio" name="general1" value="5"></td>
            </tr>
            <tr class="backtable question">
              <td class="question-text">The use of descriptive words in the playlist title enhanced my interest in listening to this playlist.</td>
              <td><input type="radio" name="general2" value="1"></td>
              <td><input type="radio" name="general2" value="2"></td>
              <td><input type="radio" name="general2" value="3"></td>
              <td><input type="radio" name="general2" value="4"></td>
              <td><input type="radio" name="general2" value="5"></td>
            </tr>
            <tr class="backtable-soft question">
              <td class="question-text">Playlist titles that are non descriptive (e.g. "Playlist 1" or "Mixtape") make the playlists less attractive.</td>
              <td><input type="radio" name="general3" value="1"></td>
              <td><input type="radio" name="general3" value="2"></td>
              <td><input type="radio" name="general3" value="3"></td>
              <td><input type="radio" name="general3" value="4"></td>
              <td><input type="radio" name="general3" value="5"></td>
            </tr>
            <tr class="backtable question">
              <td class="question-text">Playlist titles that showcase my favorite music genres or artists are valuable to me.</td>
              <td><input type="radio" name="general4" value="1"></td>
              <td><input type="radio" name="general4" value="2"></td>
              <td><input type="radio" name="general4" value="3"></td>
              <td><input type="radio" name="general4" value="4"></td>
              <td><input type="radio" name="general4" value="5"></td>
            </tr>
            <tr class="backtable-soft question">
              <td class="question-text">I am more likely to select a playlist that seems to be based on my preferences compared to a generic one.</td>
              <td><input type="radio" name="general5" value="1"></td>
              <td><input type="radio" name="general5" value="2"></td>
              <td><input type="radio" name="general5" value="3"></td>
              <td><input type="radio" name="general5" value="4"></td>
              <td><input type="radio" name="general5" value="5"></td>
            </tr>  
            <tr class="backtable question">
              <td class="question-text">Playlist titles that reflect my personal preferences enhance my overall music streaming experience.</td>
              <td><input type="radio" name="general6" value="1"></td>
              <td><input type="radio" name="general6" value="2"></td>
              <td><input type="radio" name="general6" value="3"></td>
              <td><input type="radio" name="general6" value="4"></td>
              <td><input type="radio" name="general6" value="5"></td>
            </tr>
          </table>
          </div>
        </form>
        <button style="margin-left: 5rem;" onclick="fn2()" >Submit</button>
    </main>
	<script>
//function SubForm() {
    /*  var page4I_IIFormData = sessionStorage.getItem("page4I_IIFormData");
    var page4III_IVFormData = sessionStorage.getItem("page4III_IVFormData");
    var page5FormData = sessionStorage.getItem("page5FormData");
    var page5iFormData = sessionStorage.getItem("page5iFormData");
    var page5_2FormData = sessionStorage.getItem("page5-2FormData");
    var page5i_2FormData = sessionStorage.getItem("page5i-2FormData");


    console.log(page5FormData);
    var page6FormData = $("#myForm").serialize();
    
    var formData = page4I_IIFormData + '&' + page4III_IVFormData + '&' + page5FormData + '&' + page5iFormData + '&' + page5_2FormData + '&' + page5i_2FormData + '&' + page6FormData;
    console.log(formData);
  
  $.ajax({
      url: "https://api.apispreadsheets.com/data/tpuWkFSUb3NPqdAD/",
      type: "post",
      data: formData,
      success: function() {
        window.location.href = "index7.html";
        alert("Form Data Submitted")
      },
      error: function() {
        alert("There was an error")
      }
    });
}*/

  function fn2() {
  

  let selectedNumber = 0;
  const table = document.querySelector('table');
  const rows = document.querySelectorAll('.question');

  for (let i = 0; i < rows.length; i++) {
    const inputs = rows[i].querySelectorAll('input[type="radio"]');
    
    for (let j = 0; j < inputs.length; j++) {
      if (inputs[j].checked) {
        selectedNumber++;
        console.log(selectedNumber);
      }
    }
  }

  if (selectedNumber < (rows.length)) {
    alert("Please make sure all sections are filled in.");
    console.log(selectedNumber);
  } 

  if (selectedNumber === (rows.length)) {
      //log time of taking survey
    var storedStartTime = localStorage.getItem('startTime');
    var startTime = new Date(storedStartTime);
    var endTime = new Date();
    var totalTime = (endTime.getTime() - startTime.getTime())/1000;
    var minutes = Math.floor(totalTime / 60);
    var seconds = Math.floor(totalTime % 60); 
    console.log(`total time: ${minutes} minutes, ${seconds} seconds`);
    var timeTaken = `${minutes} m, ${seconds} s`
    
    //log data from all pages
    var page4I_IIFormData = sessionStorage.getItem("page4I_IIFormData");
    var page4III_IVFormData = sessionStorage.getItem("page4III_IVFormData");
    var page5FormData = sessionStorage.getItem("page5FormData");
    var page5iFormData = sessionStorage.getItem("page5iFormData");
    var page5_2FormData = sessionStorage.getItem("page5-2FormData");
    var page5i_2FormData = sessionStorage.getItem("page5i-2FormData");
    var pageBreakFormData = sessionStorage.getItem("pageBreakFormData");
    

    console.log(page5FormData);
    var page6FormData = $("#myForm").serialize();
    
    var formData = page4I_IIFormData + '&' + page4III_IVFormData + '&' + page5FormData + '&' + page5iFormData + '&' + page5_2FormData + '&' + page5i_2FormData + '&' + page6FormData + '&Time=' + timeTaken + '&' + pageBreakFormData;
    console.log(formData);
    $.ajax({
      url: "https://api.apispreadsheets.com/data/tpuWkFSUb3NPqdAD/",
      type: "post",
      data: formData,
      success: function() {
        window.location.href = "index7.html";
        alert("Form Data Submitted")
      },
      error: function() {
        alert("There was an error")
      }
    });
    console.log('hi')
  } else {
    console.log("fail")
  }

}
  </script>
  <script src="index.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/iconify-icon@1.0.7/dist/iconify-icon.min.js"></script>
  </body>
</html>